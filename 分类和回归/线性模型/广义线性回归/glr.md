# 广义线性回归

## 1 普通线性模型

&emsp;&emsp;普通线性模型(`ordinary linear model`)可以用下式表示：

$$Y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + … + \beta_{p-1} x_{p-1} + \epsilon$$

&emsp;&emsp;这里$\beta$是未知参数，$\epsilon$是误差项。普通线性模型主要有以下几点假设：

- 响应变量$Y$和误差项$\epsilon$均服从正太分布。其中$\epsilon \sim N(0,{{\sigma }^{2}})$，$Y\sim N({{\beta }^{T}}x,{{\sigma }^{2}})$。
- 预测量$x_i$和未知参数$\beta_i$均具有非随机性。预测量$x_i$具有非随机性、可测且不存在测量误差；未知参数$\beta_i$被认为是未知但不具随机性的常数。
- 普通线性模型的输出项是随机变量$Y$。普通线性模型主要研究响应变量的期望$E[Y]$。
- 连接方式：在上面三点假设下，对上式两边取数学期望，可得

$$E[Y] = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + … + \beta_{p-1} x_{p-1}$$

&emsp;&emsp;在普通线性模型里，响应变量的均值$E[Y]$与预测量的线性组合$\beta_0 + \beta_1 x_1 + \beta_2 x_2 + … + \beta_{p-1} x_{p-1}$通过恒等式(`identity`)连接。
也可以说是通过$f(x)=x$这个链接函数(`link function`)连接。

## 2 广义线性模型

&emsp;&emsp;广义线性模型(`generalized linear model`)是在普通线性模型的基础上，对上述四点假设进行推广而得出的应用范围更广，更具实用性的回归模型。
主要有两点不同，这两点分别是：

- 响应变量$Y$和误差项$\epsilon$的分布推广至指数分散族(`exponential dispersion family`)。在`spark ml`中，广义线性回归支持的分布分别是正态分布、泊松分布、二项分布以及伽玛分布。
- 连接方式：广义线性模型里采用的链接函数(`link function`)理论上可以是任意的，，而不再局限于$f(x)=x$。

&emsp;&emsp;这里需要重点说明一下链接函数。链接函数描述了线性预测$X\beta$与分布期望值$E[Y]$的关系：$E[Y] = \mu = g^{-1}(X\beta)$，其中$g$表示链接函数。
一般情况下，高斯分布对应于恒等式，泊松分布对应于自然对数函数等。下面列出了`spark ml`中提供的链接函数以及该链接函数使用的指数分布。

| 连接函数名称 | 链接函数 | 对应的指数分布 |
|------------|-------|-------------|
| identity（恒等）| $\mu = X\beta$ | 高斯分布，泊松分布，伽马分布 |
| inverse（倒数）| $\mu^{-1} = X\beta$ | 高斯分布，伽马分布 |
| sqrt(均分) | $\mu^{2} = X\beta$ | 泊松分布 |
| log（对数）| $ln(\mu) = X\beta$ | 高斯分布，泊松分布，伽马分布 |
| logit | $ln(\frac{\mu }{1-\mu }) = X\beta$ | 高斯分布，泊松分布，伽马分布 |
| cloglog | $ln(- ln(1-\mu)) = X\beta$ | 二次分布 |
| probit | 标准高斯分布的inverse CDF，其中p值为$\mu$ | 二次分布 |
